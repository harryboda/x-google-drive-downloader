# ä»£ç å®¡æŸ¥æ£€æŸ¥æ¸…å•

## JSON æ¨¡å‹å’Œåºåˆ—åŒ–

### ğŸ” å¿…é¡»æ£€æŸ¥é¡¹

- [ ] **æ²¡æœ‰ä½¿ç”¨å±é™©çš„å¼ºåˆ¶ç±»å‹è½¬æ¢**
  ```dart
  // âŒ ç¦æ­¢
  (json['field'] as num).toInt()
  (json['field'] as int) 
  
  // âœ… å¿…é¡»ä½¿ç”¨
  @JsonKey(fromJson: _parseField)
  static int _parseField(dynamic value) { /* å®‰å…¨è§£æ */ }
  ```

- [ ] **æ‰€æœ‰æ•°å€¼å­—æ®µéƒ½æœ‰è‡ªå®šä¹‰è§£æå™¨**
  - int å­—æ®µ: `@JsonKey(fromJson: _parseInt)`
  - int? å­—æ®µ: `@JsonKey(fromJson: _parseOptionalInt)`  
  - double å­—æ®µ: `@JsonKey(fromJson: _parseDouble)`

- [ ] **è§£æå™¨è¦†ç›–æ‰€æœ‰è¾“å…¥ç±»å‹**
  ```dart
  static int _parseInt(dynamic value) {
    if (value is int) return value;        // âœ…
    if (value is double) return value.toInt(); // âœ… 
    if (value is String) return int.parse(value); // âœ…
    throw ArgumentError('...'); // âœ… æ˜ç¡®é”™è¯¯
  }
  ```

- [ ] **é”™è¯¯å¤„ç†ç­–ç•¥æ­£ç¡®**
  - å…³é”®å­—æ®µ: æŠ›å‡º `ArgumentError` 
  - å¯é€‰å­—æ®µ: è¿”å› `null`

- [ ] **ç”Ÿæˆçš„ .g.dart æ–‡ä»¶ä½¿ç”¨è‡ªå®šä¹‰è§£æå™¨**
  ```dart
  // âœ… æ­£ç¡®
  field: Model._parseField(json['field'])
  
  // âŒ éœ€è¦ä¿®å¤
  field: (json['field'] as num).toInt()
  ```

## æ•°æ®æµå’ŒçŠ¶æ€ç®¡ç†

### ğŸ” ç±»å‹ä¸€è‡´æ€§æ£€æŸ¥

- [ ] **ç™¾åˆ†æ¯”è®¡ç®—æ˜ç¡®ä½¿ç”¨ double**
  ```dart
  // âœ… æ­£ç¡®
  percentage: (count / total * 100).toDouble()
  
  // âŒ ç±»å‹ä¸ç¡®å®š
  percentage: count / total * 100
  ```

- [ ] **ç»Ÿä¸€æ•°å€¼ç±»å‹ç­–ç•¥**
  - ç™¾åˆ†æ¯”: `double` (0.0-100.0)
  - è®¡æ•°: `int`
  - å¤§å°: `int` (bytes)

- [ ] **copyWith è°ƒç”¨ç±»å‹å®‰å…¨**
  ```dart
  // âœ… æ˜ç¡®ç±»å‹
  progress.copyWith(percentage: 50.0)
  
  // âŒ å¯èƒ½ç±»å‹é”™è¯¯  
  progress.copyWith(percentage: 50)
  ```

## Provider å’Œä¾èµ–æ³¨å…¥

### ğŸ” æ¶æ„æ£€æŸ¥

- [ ] **Provider ç±»å‹å£°æ˜æ­£ç¡®**
  ```dart
  // âœ… æ˜ç¡®æ³›å‹ç±»å‹
  Consumer<DownloadService>(
    builder: (context, service, child) => ...
  )
  ```

- [ ] **é¿å…å¾ªç¯ä¾èµ–**
- [ ] **æœåŠ¡åˆå§‹åŒ–é¡ºåºæ­£ç¡®**

## é”™è¯¯å¤„ç†

### ğŸ” é”™è¯¯å¤„ç†æ£€æŸ¥

- [ ] **catch å—å¤„ç†å…·ä½“å¼‚å¸¸ç±»å‹**
  ```dart
  try {
    // æ“ä½œ
  } on FormatException catch (e) {
    // å…·ä½“å¤„ç†
  } on ArgumentError catch (e) {
    // å…·ä½“å¤„ç†  
  } catch (e) {
    // é€šç”¨å¤„ç†
  }
  ```

- [ ] **é”™è¯¯ä¿¡æ¯åŒ…å«è°ƒè¯•ä¿¡æ¯**
  ```dart
  throw ArgumentError('æ— æ³•è§£æå­—æ®µå€¼: $value (ç±»å‹: ${value.runtimeType})');
  ```

## æµ‹è¯•è¦†ç›–

### ğŸ” æµ‹è¯•è¦æ±‚

- [ ] **æ¯ä¸ªè‡ªå®šä¹‰è§£æå™¨éƒ½æœ‰å•å…ƒæµ‹è¯•**
- [ ] **æµ‹è¯•è¦†ç›–æ‰€æœ‰è¾“å…¥ç±»å‹**: int, double, String, null
- [ ] **æµ‹è¯•è¾¹ç•Œæƒ…å†µå’Œå¼‚å¸¸åœºæ™¯**
- [ ] **é›†æˆæµ‹è¯•éªŒè¯å®Œæ•´æ•°æ®æµ**

## æ€§èƒ½è€ƒè™‘

### ğŸ” æ€§èƒ½æ£€æŸ¥

- [ ] **é¿å…ä¸å¿…è¦çš„ç±»å‹è½¬æ¢**
- [ ] **ç¼“å­˜æ˜‚è´µçš„è®¡ç®—ç»“æœ**
- [ ] **ä½¿ç”¨ const æ„é€ å‡½æ•°**

## æ–‡æ¡£å’Œæ³¨é‡Š

### ğŸ” æ–‡æ¡£æ£€æŸ¥

- [ ] **å¤æ‚çš„ç±»å‹è½¬æ¢é€»è¾‘æœ‰æ³¨é‡Šè¯´æ˜**
- [ ] **è‡ªå®šä¹‰è§£æå™¨æœ‰æ–‡æ¡£è¯´æ˜å¤„ç†çš„è¾“å…¥ç±»å‹**
- [ ] **å¼‚å¸¸æƒ…å†µæœ‰æ¸…æ™°çš„æ–‡æ¡£**

## æ„å»ºå’Œéƒ¨ç½²

### ğŸ” æ„å»ºæ£€æŸ¥

- [ ] **è¿è¡Œ build_runner é‡æ–°ç”Ÿæˆä»£ç **
  ```bash
  flutter packages pub run build_runner build --delete-conflicting-outputs
  ```

- [ ] **æ„å»ºæ— è­¦å‘Šå’Œé”™è¯¯**
- [ ] **æ‰€æœ‰æµ‹è¯•é€šè¿‡**
- [ ] **é™æ€åˆ†æé€šè¿‡** (`flutter analyze`)

## å®¡æŸ¥ç­¾å­—

### å®¡æŸ¥è€…æ£€æŸ¥æ¸…å•

- [ ] æˆ‘å·²æ£€æŸ¥æ‰€æœ‰ JSON æ¨¡å‹çš„ç±»å‹å®‰å…¨æ€§
- [ ] æˆ‘å·²éªŒè¯æ•°æ®æµä¸­çš„ç±»å‹ä¸€è‡´æ€§  
- [ ] æˆ‘å·²ç¡®è®¤é”™è¯¯å¤„ç†ç­–ç•¥é€‚å½“
- [ ] æˆ‘å·²æ£€æŸ¥æµ‹è¯•è¦†ç›–æƒ…å†µ
- [ ] ä»£ç ç¬¦åˆé¡¹ç›®çš„ç±»å‹å®‰å…¨è§„èŒƒ

**å®¡æŸ¥è€…**: _______________  
**æ—¥æœŸ**: _______________  
**å¤‡æ³¨**: _______________

---

## å¿«é€Ÿæ£€æŸ¥å‘½ä»¤

```bash
# æ£€æŸ¥å±é™©çš„ç±»å‹è½¬æ¢
grep -r "as num" lib/ && echo "âš ï¸ å‘ç°ä¸å®‰å…¨è½¬æ¢!" || echo "âœ… ç±»å‹è½¬æ¢å®‰å…¨"

# æ£€æŸ¥ç”Ÿæˆçš„ä»£ç 
grep -r "_parse" lib/**/*.g.dart && echo "âœ… ä½¿ç”¨è‡ªå®šä¹‰è§£æå™¨" || echo "âš ï¸ æœªä½¿ç”¨è‡ªå®šä¹‰è§£æå™¨"

# è¿è¡Œæ‰€æœ‰æ£€æŸ¥
flutter analyze && flutter test && echo "âœ… æ‰€æœ‰æ£€æŸ¥é€šè¿‡"
```